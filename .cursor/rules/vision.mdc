---
alwaysApply: true
description: Technical vision and architectural principles for the gunsmith barrel calculator
---

# Technical Vision

## **Core Philosophy**
Build a **precision engineering tool** disguised as a simple web app - where complex thick-walled cylinder analysis becomes as accessible as a pocket calculator, yet maintains the rigor expected by professional engineers.

## **Architectural Principles**

### **Client-First Architecture**
- **Zero server dependency** - Everything runs in the browser
- **Offline-capable** - Works without internet after initial load  
- **Static deployment** - GitHub Pages compatible
- **Progressive enhancement** - Graceful degradation across devices

### **Modular Engineering**
- **Pure ES6 modules** with explicit imports/exports
- **Domain separation** - Units, calculations, UI, and data as distinct modules
- **Event-driven coupling** - Components communicate via CustomEvents
- **Testable units** - Each module independently verifiable

### **Calculation Architecture**
- **Mathematical purity** - Core calculations isolated from UI concerns
- **SI base unit consistency** - All computations in mm/MPa internally with boundary conversions
- **Numerical robustness** - 1e-9 convergence tolerance for iterative solvers
- **Error propagation** - Structured error handling from computation through UI display
- **Performance targets** - Sub-millisecond analysis for real-time responsiveness
- **Validation integration** - Calculation results feed back into form validation system
- **Asynchronous processing** - Complex multi-scenario analyses run without blocking UI interaction
- **Graceful degradation** - Fallback mechanisms ensure core functionality when advanced features fail
- **Modular analysis types** - Support for both single-cylinder and compound-cylinder calculations
- **Stress superposition** - Proper handling of multiple loading conditions (preload + operating)

### **Data Architecture Principles**
- **Standards compliance** - Engineering data based on published standards (ISO 286, ANSI B4.2)
- **Interpolation accuracy** - Linear interpolation provides smooth transitions between discrete tolerance values
- **Caching strategies** - Expensive data loads cached for performance with intelligent fallbacks
- **JSON structure design** - Human-readable data formats enabling easy validation and modification
- **Unit boundary isolation** - Raw data in standard units with conversion only at presentation layer

### **Precision-First Design**
- **SI canonical storage** - All internal calculations in metric base units
- **Boundary conversions** - Unit conversion only at UI interfaces
- **Tolerance awareness** - 1e-9 relative precision for engineering accuracy
- **No precision drift** - Round-trip conversions preserve original values

### **Professional UX Standards**
- **Mobile-first responsive** - Bootstrap 5.3 with semantic HTML
- **WCAG 2.1 AA accessibility** - Full keyboard navigation and screen reader support
- **Real-time validation** - Immediate feedback without form submission
- **Progressive disclosure** - Advanced features hidden until needed

### **Results Presentation Standards**
- **Safety-first indicators** - Color-coded status with clear pass/fail thresholds
- **Contextual data density** - Summary cards for quick assessment, detailed tables for analysis
- **Multi-scenario comparisons** - Side-by-side nominal, worst-case, and best-case analyses
- **Traceability requirements** - Input recap and calculation methodology always visible
- **Error communication** - Technical accuracy with non-jargon explanations
- **Professional credibility** - Engineering units, significant figures, and conservative estimates
- **Progressive complexity** - Basic results shown first, advanced tolerance analysis revealed contextually
- **Manufacturing awareness** - Results clearly communicate real-world manufacturing implications

## **Validation & User Experience Principles**

### **Intelligent Validation**
- **Debounced real-time validation** - 250ms delay prevents excessive validation calls
- **Cross-field validation** - Logical constraints (OD > ID) enforced automatically
- **Engineering relationship validation** - Contextual warnings based on wall thickness ratios and pressure levels
- **Compound geometry validation** - Trunnion compatibility and interference fit validation
- **Non-jargon error messages** - Clear, actionable feedback for engineers
- **Field-specific validation** - Context-aware validation rules per input type
- **Required field indicators** - Visual cues with accessibility support
- **Tolerance-aware warnings** - Smart alerts for manufacturing feasibility and safety implications

### **Progressive Disclosure Implementation**
- **Bootstrap accordion structure** - Collapsible advanced options (trunnion, tolerances)
- **Conditional field visibility** - Custom material properties shown only when needed
- **Smart defaults** - Pre-populated values for common materials and configurations
- **Material database integration** - Predefined properties for common barrel steels
- **Graceful degradation** - Essential fields always visible, advanced options hidden by default

### **Responsive Design Strategy**
- **Mobile offcanvas synchronization** - Bidirectional form state sync between desktop and mobile
- **Form-floating controls** - Modern Bootstrap 5.3 input styling with proper labels
- **Fieldset organization** - Logical grouping of related inputs with semantic HTML
- **Touch-friendly targets** - Adequate spacing and sizing for mobile interaction

## **Implementation Strategy**
Focus on **engineering correctness over feature completeness** - each module must be mathematically sound and thoroughly tested before moving to the next layer of functionality.

### **Implementation Strategy Proven**
Through Tasks 4-6 implementation, we've validated that:

**Form & Validation (Task 4):**
- **Form validation complexity** can be managed through modular functions
- **Unit conversion reliability** is maintained through consistent SI canonical storage
- **Progressive disclosure** enhances UX without sacrificing professional capability
- **Accessibility standards** are achievable with proper ARIA implementation
- **Mobile responsiveness** requires careful state synchronization but is fully achievable

**Calculation Engine (Task 5):**
- **Mathematical isolation** enables independent testing and validation of core algorithms
- **Numerical convergence** patterns (bisection method) provide robust solutions within performance constraints
- **Error boundary design** allows graceful degradation from calculation errors to user-friendly messages
- **Unit conversion architecture** seamlessly bridges display units and SI computational units
- **Results integration** with existing form validation creates cohesive user experience flow
- **Performance optimization** achieves sub-millisecond calculations suitable for real-time interaction

**Tolerance & Manufacturing Analysis (Task 6):**
- **Standards-based tolerance systems** (ISO 286, ANSI B4.2) can be efficiently implemented with lookup tables and interpolation
- **Asynchronous calculation patterns** enable complex multi-scenario analysis without blocking the UI
- **Fallback data strategies** ensure robustness when external data sources fail
- **Contextual validation systems** provide intelligent warnings based on engineering relationships
- **Professional results presentation** scales effectively from simple nominal cases to complex worst-case scenarios
- **Test-driven tolerance validation** ensures numerical accuracy across edge cases and real-world manufacturing scenarios

**Compound Cylinder/Trunnion Analysis (Task 7):**
- **Elasticity-based contact pressure** calculation using proper Lam√© equations for interference fits
- **Stress superposition architecture** cleanly separates preload and operating pressure contributions
- **Multi-region stress analysis** handles barrel and trunnion with different material properties
- **Critical location monitoring** identifies worst-case stresses across interface and surfaces
- **Numerical stability** maintains accuracy for small interference fits (0.001mm) without computational issues
- **Geometry validation integration** provides intelligent warnings for thin walls and excessive interference
- **Progressive analysis complexity** - seamlessly switches between single and compound cylinder modes
- **Test coverage excellence** - 11 comprehensive unit tests covering all edge cases and error conditions

**Material Database Integration (Task 8):**
- **JSON-based material library** with comprehensive properties database following engineering standards
- **Async loading with intelligent caching** - Static fetch with fallback mechanisms for offline capability
- **Unit-aware property management** - Seamless conversion between SI and Imperial units at presentation layer
- **Category-based organization** - Materials grouped by type (Carbon Steel, Stainless Steel, Superalloy, Titanium)
- **Dynamic UI generation** - Form components built from database structure with progressive disclosure
- **Custom material validation** - Engineering-aware validation with cross-field checks (yield vs ultimate strength)
- **Graceful error handling** - Fallback to essential materials when database loading fails
- **Professional data curation** - Source-referenced properties with condition specifications and application notes
- **Search and filtering capabilities** - Multiple search criteria including name, category, and application
- **Mobile-responsive integration** - Synchronized material selection across desktop and mobile interfaces
